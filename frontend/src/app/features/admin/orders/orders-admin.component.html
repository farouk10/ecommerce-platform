<div class="p-6 space-y-6 bg-slate-50 min-h-screen">
  <!-- Header -->
  <div
    class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4"
  >
    <div>
      <h1 class="text-2xl font-bold text-slate-900 tracking-tight">
        Gestions des Commandes
      </h1>
      <p class="text-slate-500 mt-1">
        Gérez et suivez toutes les commandes clients
      </p>
    </div>

    <div
      class="flex items-center gap-3 bg-white p-1 rounded-lg border border-slate-200 shadow-sm"
    >
      <button
        (click)="loadOrders()"
        class="p-2 text-slate-600 hover:text-primary-600 hover:bg-slate-50 rounded-md transition-colors"
        title="Actualiser"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          class="w-5 h-5"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"
          />
        </svg>
      </button>
    </div>
  </div>

  <!-- Stats Overview -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
    <div
      class="bg-white p-5 rounded-xl border border-slate-100 shadow-sm hover:shadow-md transition-shadow"
    >
      <div class="flex justify-between items-start">
        <div>
          <p class="text-sm font-medium text-slate-500">En attente</p>
          <h3 class="text-2xl font-bold text-slate-900 mt-1">
            {{ getCountByStatus("PENDING") }}
          </h3>
        </div>
        <span class="p-2 bg-amber-50 text-amber-600 rounded-lg">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="w-6 h-6"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"
            />
          </svg>
        </span>
      </div>
    </div>

    <div
      class="bg-white p-5 rounded-xl border border-slate-100 shadow-sm hover:shadow-md transition-shadow"
    >
      <div class="flex justify-between items-start">
        <div>
          <p class="text-sm font-medium text-slate-500">Confirmées</p>
          <h3 class="text-2xl font-bold text-slate-900 mt-1">
            {{ getCountByStatus("CONFIRMED") }}
          </h3>
        </div>
        <span class="p-2 bg-blue-50 text-blue-600 rounded-lg">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="w-6 h-6"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
            />
          </svg>
        </span>
      </div>
    </div>

    <div
      class="bg-white p-5 rounded-xl border border-slate-100 shadow-sm hover:shadow-md transition-shadow"
    >
      <div class="flex justify-between items-start">
        <div>
          <p class="text-sm font-medium text-slate-500">Expédiées</p>
          <h3 class="text-2xl font-bold text-slate-900 mt-1">
            {{ getCountByStatus("SHIPPED") }}
          </h3>
        </div>
        <span class="p-2 bg-indigo-50 text-indigo-600 rounded-lg">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="w-6 h-6"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M8.25 18.75a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 01-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 00-3.213-9.193 2.056 2.056 0 00-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 00-10.026 0 1.106 1.106 0 00-.987 1.106v7.635m12-6.677v6.677m0 4.5v-4.5m0 0h-12"
            />
          </svg>
        </span>
      </div>
    </div>

    <div
      class="bg-white p-5 rounded-xl border border-slate-100 shadow-sm hover:shadow-md transition-shadow"
    >
      <div class="flex justify-between items-start">
        <div>
          <p class="text-sm font-medium text-slate-500">Livrées</p>
          <h3 class="text-2xl font-bold text-slate-900 mt-1">
            {{ getCountByStatus("DELIVERED") }}
          </h3>
        </div>
        <span class="p-2 bg-emerald-50 text-emerald-600 rounded-lg">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="w-6 h-6"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5m8.25 3.25h3m-3-3.75h3m-12-3h15.75c.828 0 1.5.672 1.5 1.5v2.25c0 .828-.672 1.5-1.5 1.5h-15.75c-.828 0-1.5-.672-1.5-1.5v-2.25c0-.828.672-1.5 1.5-1.5z"
            />
          </svg>
        </span>
      </div>
    </div>
  </div>

  <!-- Filters & Search -->
  <div
    class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex flex-col md:flex-row gap-4 items-center justify-between"
  >
    <div class="relative w-full md:w-96">
      <div
        class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"
      >
        <svg
          class="h-5 w-5 text-slate-400"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
          />
        </svg>
      </div>
      <input
        type="text"
        [(ngModel)]="searchTerm"
        (input)="filterOrders()"
        class="block w-full pl-10 pr-3 py-2 border border-slate-300 rounded-lg leading-5 bg-white placeholder-slate-400 focus:outline-none focus:ring-1 focus:ring-primary-500 focus:border-primary-500 sm:text-sm"
        placeholder="Rechercher par N° commande ou User ID..."
      />
    </div>

    <div class="flex items-center gap-3 w-full md:w-auto">
      <select
        [(ngModel)]="statusFilter"
        (change)="filterOrders()"
        class="block w-full md:w-48 pl-3 pr-10 py-2 text-base border-slate-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-lg"
      >
        <option value="">Tous les statuts</option>
        <option value="PENDING">En attente</option>
        <option value="CONFIRMED">Confirmée</option>
        <option value="PROCESSING">En préparation</option>
        <option value="SHIPPED">Expédiée</option>
        <option value="DELIVERED">Livrée</option>
        <option value="CANCELLED">Annulée</option>
      </select>
    </div>
  </div>

  <!-- Orders Table -->
  <div
    class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden"
  >
    <div class="overflow-x-auto">
      <table class="min-w-full divide-y divide-slate-200">
        <thead class="bg-slate-50">
          <tr>
            <th
              scope="col"
              class="px-6 py-3 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider"
            >
              Commande
            </th>
            <th
              scope="col"
              class="px-6 py-3 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider"
            >
              Client
            </th>
            <th
              scope="col"
              class="px-6 py-3 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider"
            >
              Date
            </th>
            <th
              scope="col"
              class="px-6 py-3 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider"
            >
              Montant
            </th>
            <th
              scope="col"
              class="px-6 py-3 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider"
            >
              Statut
            </th>
            <th
              scope="col"
              class="px-6 py-3 text-right text-xs font-semibold text-slate-500 uppercase tracking-wider"
            >
              Actions
            </th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-slate-200">
          <tr
            *ngFor="let order of filteredOrders"
            class="hover:bg-slate-50 transition-colors"
          >
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="flex items-center">
                <div>
                  <div class="text-sm font-bold text-gray-900">
                    #{{ order.orderNumber }}
                  </div>
                  <div class="text-xs text-gray-500 mt-0.5">
                    ID: {{ order.id }}
                  </div>
                </div>
              </div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="flex items-center">
                <div
                  class="h-8 w-8 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-700 font-bold text-xs mr-3"
                >
                  {{ (order.clientName || "NC").charAt(0).toUpperCase() }}
                </div>
                <div>
                  <div class="text-sm font-medium text-gray-900">
                    {{ order.clientName || "Inconnu" }}
                  </div>
                  <div class="text-xs text-gray-500">
                    {{ order.clientEmail || order.userId }}
                  </div>
                </div>
              </div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="text-sm text-gray-900 font-medium">
                {{ formatDate(order.createdAt) }}
              </div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="text-sm font-semibold text-slate-900">
                {{ formatPrice(order.totalAmount) }}
              </div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <span
                [class]="
                  'px-2.5 py-1 text-xs font-semibold rounded-full border ' +
                  getStatusBadgeClass(order.status)
                "
              >
                {{ getStatusLabel(order.status) }}
              </span>
            </td>
            <td
              class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium"
            >
              <div class="flex justify-end gap-2">
                <!-- Status Actions -->
                <button
                  *ngIf="order.status === 'PENDING'"
                  (click)="updateStatus(order.id, 'CONFIRMED')"
                  class="p-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors"
                  title="Confirmer la commande"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="w-5 h-5"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                    />
                  </svg>
                </button>

                <button
                  *ngIf="order.status === 'CONFIRMED'"
                  (click)="updateStatus(order.id, 'PROCESSING')"
                  class="p-1.5 text-indigo-600 hover:bg-indigo-50 rounded transition-colors"
                  title="Préparer"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="w-5 h-5"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M11.42 15.17L17.25 21A2.652 2.652 0 0021 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.317-.384.74-.626 1.208-.766M11.42 15.17l-4.655 5.653a2.548 2.548 0 11-3.586-3.586l6.837-5.63m5.108-.233c.55-.164 1.163-.188 1.743-.14a4.5 4.5 0 00-4.486-6.136c-1.87 0-3.869 1.03-4.582 1.325.803.906 1.637 1.682 2.125 2.212zm-6.524-2.438l-4.963 1.25a2.5 2.5 0 00-1.789 1.087l-.95 1.505 5.11 3.85.935-1.483a2.5 2.5 0 00.32-2.19z"
                    />
                  </svg>
                </button>

                <button
                  *ngIf="order.status === 'PROCESSING'"
                  (click)="updateStatus(order.id, 'SHIPPED')"
                  class="p-1.5 text-purple-600 hover:bg-purple-50 rounded transition-colors"
                  title="Expédier"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="w-5 h-5"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M8.25 18.75a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 01-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 00-3.213-9.193 2.056 2.056 0 00-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 00-10.026 0 1.106 1.106 0 00-.987 1.106v7.635m12-6.677v6.677m0 4.5v-4.5m0 0h-12"
                    />
                  </svg>
                </button>

                <button
                  *ngIf="order.status === 'SHIPPED'"
                  (click)="updateStatus(order.id, 'DELIVERED')"
                  class="p-1.5 text-emerald-600 hover:bg-emerald-50 rounded transition-colors"
                  title="Marquer comme Livré"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="w-5 h-5"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M9 12.75L11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 01-1.043 3.296 3.745 3.745 0 01-3.296 1.043A3.745 3.745 0 0112 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 01-3.296-1.043 3.745 3.745 0 01-1.043-3.296A3.745 3.745 0 013 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 011.043-3.296 3.746 3.746 0 013.296-1.043A3.746 3.746 0 0112 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 013.296 1.043 3.746 3.746 0 011.043 3.296A3.745 3.745 0 0121 12z"
                    />
                  </svg>
                </button>

                <!-- View Detail -->
                <button
                  (click)="viewDetails(order.id)"
                  class="p-1.5 text-slate-500 hover:text-slate-700 hover:bg-slate-100 rounded transition-colors"
                  title="Voir détails"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="w-5 h-5"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"
                    />
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
                    />
                  </svg>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Empty State -->
    <div
      *ngIf="filteredOrders.length === 0 && !isLoading"
      class="text-center py-16"
    >
      <div
        class="mx-auto h-24 w-24 bg-slate-50 rounded-full flex items-center justify-center mb-4"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          class="w-12 h-12 text-slate-300"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"
          />
        </svg>
      </div>
      <h3 class="text-lg font-medium text-slate-900">
        Aucune commande trouvée
      </h3>
      <p class="text-slate-500 mt-1">
        Essayez de modifier vos filtres ou votre recherche.
      </p>
    </div>

    <!-- Loading -->
    <div *ngIf="isLoading" class="p-12 text-center">
      <div
        class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"
      ></div>
      <p class="mt-4 text-slate-500">Chargement des commandes...</p>
    </div>
  </div>
</div>
