<div
  *ngIf="isOpen"
  class="fixed inset-0 z-[100] flex items-start justify-center pt-[15vh] px-4 animate-fade-in"
>
  <!-- Backdrop -->
  <div
    class="fixed inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity"
    (click)="close()"
  ></div>

  <!-- Modal -->
  <div
    class="relative w-full max-w-2xl bg-white rounded-xl shadow-2xl border border-white/20 overflow-hidden transform transition-all animate-scale-in flex flex-col max-h-[60vh]"
  >
    <!-- Search Bar -->
    <div class="flex items-center border-b border-slate-100 px-4 py-3 gap-3">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-6 w-6 text-slate-400"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
        />
      </svg>
      <input
        #searchInput
        [formControl]="searchControl"
        type="text"
        placeholder="Rechercher ou lancer une commande..."
        class="flex-1 bg-transparent border-none text-lg text-slate-700 placeholder-slate-400 focus:ring-0 focus:outline-none"
      />
      <div class="flex items-center gap-1">
        <span
          class="text-[10px] font-bold text-slate-400 bg-slate-100 px-1.5 py-0.5 rounded border border-slate-200"
          >ESC</span
        >
      </div>
    </div>

    <!-- Results List -->
    <div class="overflow-y-auto custom-scrollbar p-2 space-y-1">
      <div
        *ngIf="filteredResults.length === 0"
        class="text-center py-8 text-slate-500"
      >
        Aucun résultat trouvé.
      </div>

      <div
        *ngFor="let result of filteredResults; let i = index"
        (click)="selectResult(result)"
        (mouseenter)="selectedIndex = i"
        class="flex items-center gap-3 px-3 py-3 rounded-lg cursor-pointer transition-colors group"
        [ngClass]="{
          'bg-indigo-50': i === selectedIndex,
          'hover:bg-indigo-50': i !== selectedIndex
        }"
      >
        <div
          class="w-8 h-8 rounded-lg flex items-center justify-center bg-white border border-slate-100 text-lg shadow-sm group-hover:border-indigo-200 group-hover:scale-105 transition-transform"
          [ngClass]="{ 'border-indigo-200': i === selectedIndex }"
        >
          {{ result.icon }}
        </div>
        <div class="flex-1">
          <h4
            class="text-sm font-semibold text-slate-800"
            [ngClass]="{ 'text-indigo-700': i === selectedIndex }"
          >
            {{ result.title }}
          </h4>
          <p *ngIf="result.description" class="text-xs text-slate-500">
            {{ result.description }}
          </p>
        </div>

        <!-- Enter Hint -->
        <div *ngIf="i === selectedIndex" class="text-indigo-400">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-4 w-4"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M14 5l7 7m0 0l-7 7m7-7H3"
            />
          </svg>
        </div>

        <div
          *ngIf="i !== selectedIndex"
          class="text-[10px] font-bold text-slate-400 uppercase tracking-wider"
        >
          {{ result.group }}
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div
      class="bg-slate-50 border-t border-slate-100 px-4 py-2 flex items-center justify-between text-xs text-slate-400"
    >
      <div class="flex gap-4">
        <span class="flex items-center gap-1"
          ><kbd class="font-sans px-1 bg-white border border-slate-200 rounded"
            >↓</kbd
          >
          <kbd class="font-sans px-1 bg-white border border-slate-200 rounded"
            >↑</kbd
          >
          pour naviguer</span
        >
        <span class="flex items-center gap-1"
          ><kbd class="font-sans px-1 bg-white border border-slate-200 rounded"
            >↵</kbd
          >
          pour valider</span
        >
      </div>
      <div>eCommerce OS</div>
    </div>
  </div>
</div>
