--
-- PostgreSQL database dump
--

\restrict v0OP3YbUi7ceByUeYjCSx0Fe25BGXfQHSn9ShEYXSLrf2oMDChKQ5liq6CqjdgF

-- Dumped from database version 15.15
-- Dumped by pg_dump version 15.15

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

SET default_tablespace = '';

SET default_table_access_method = heap;

--
-- Name: categories; Type: TABLE; Schema: public; Owner: ecommerce
--

CREATE TABLE public.categories (
    id bigint NOT NULL,
    name character varying(255) NOT NULL,
    parent_id bigint,
    description character varying(500)
);


ALTER TABLE public.categories OWNER TO ecommerce;

--
-- Name: categories_id_seq; Type: SEQUENCE; Schema: public; Owner: ecommerce
--

ALTER TABLE public.categories ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.categories_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: flyway_schema_history; Type: TABLE; Schema: public; Owner: ecommerce
--

CREATE TABLE public.flyway_schema_history (
    installed_rank integer NOT NULL,
    version character varying(50),
    description character varying(200) NOT NULL,
    type character varying(20) NOT NULL,
    script character varying(1000) NOT NULL,
    checksum integer,
    installed_by character varying(100) NOT NULL,
    installed_on timestamp without time zone DEFAULT now() NOT NULL,
    execution_time integer NOT NULL,
    success boolean NOT NULL
);


ALTER TABLE public.flyway_schema_history OWNER TO ecommerce;

--
-- Name: product_images; Type: TABLE; Schema: public; Owner: ecommerce
--

CREATE TABLE public.product_images (
    product_id bigint NOT NULL,
    image_url character varying(255)
);


ALTER TABLE public.product_images OWNER TO ecommerce;

--
-- Name: products; Type: TABLE; Schema: public; Owner: ecommerce
--

CREATE TABLE public.products (
    id bigint NOT NULL,
    created_at timestamp(6) without time zone,
    description text,
    name character varying(255) NOT NULL,
    price numeric(38,2) NOT NULL,
    stock_quantity integer,
    updated_at timestamp(6) without time zone,
    category_id bigint
);


ALTER TABLE public.products OWNER TO ecommerce;

--
-- Name: products_id_seq; Type: SEQUENCE; Schema: public; Owner: ecommerce
--

ALTER TABLE public.products ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.products_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Data for Name: categories; Type: TABLE DATA; Schema: public; Owner: ecommerce
--

COPY public.categories (id, name, parent_id, description) FROM stdin;
1	Electronics	\N	Electronic devices and gadgets
2	Computers	\N	Laptops, desktops, and accessories
3	Smartphones	\N	Mobile phones and accessories
4	Computers	\N	Laptops, desktops, and accessories
5	Smartphones	\N	Mobile phones and accessories
\.


--
-- Data for Name: flyway_schema_history; Type: TABLE DATA; Schema: public; Owner: ecommerce
--

COPY public.flyway_schema_history (installed_rank, version, description, type, script, checksum, installed_by, installed_on, execution_time, success) FROM stdin;
1	1	<< Flyway Baseline >>	BASELINE	<< Flyway Baseline >>	\N	ecommerce	2025-12-03 01:37:40.275814	0	t
2	2	add indexes	SQL	V2__add_indexes.sql	388532258	ecommerce	2025-12-03 01:37:40.362541	47	t
\.


--
-- Data for Name: product_images; Type: TABLE DATA; Schema: public; Owner: ecommerce
--

COPY public.product_images (product_id, image_url) FROM stdin;
1	iphone.jpg
2	iphone-15-pro-max.jpg
3	macbook-pro-14.jpg
4	ps5.jpg
5	airpods.jpg
\.


--
-- Data for Name: products; Type: TABLE DATA; Schema: public; Owner: ecommerce
--

COPY public.products (id, created_at, description, name, price, stock_quantity, updated_at, category_id) FROM stdin;
2	\N	256GB, Titanium Blue	iPhone 15 Pro Max	1399.99	100	\N	3
3	\N	Apple M3 chip, 16GB RAM, 512GB SSD	MacBook Pro 14	2299.99	50	\N	2
4	\N	825GB SSD, Digital Edition	PlayStation 5	499.99	70	\N	1
5	\N	Active noise cancellation	AirPods Pro 2	249.99	200	\N	1
7	\N	Powerful laptop with M4 chip	MacBook Pro M4	2999.99	50	\N	1
1	\N	New iPhone	iPhone 16 Pro	1299.99	50	\N	3
\.


--
-- Name: categories_id_seq; Type: SEQUENCE SET; Schema: public; Owner: ecommerce
--

SELECT pg_catalog.setval('public.categories_id_seq', 5, true);


--
-- Name: products_id_seq; Type: SEQUENCE SET; Schema: public; Owner: ecommerce
--

SELECT pg_catalog.setval('public.products_id_seq', 7, true);


--
-- Name: categories categories_pkey; Type: CONSTRAINT; Schema: public; Owner: ecommerce
--

ALTER TABLE ONLY public.categories
    ADD CONSTRAINT categories_pkey PRIMARY KEY (id);


--
-- Name: flyway_schema_history flyway_schema_history_pk; Type: CONSTRAINT; Schema: public; Owner: ecommerce
--

ALTER TABLE ONLY public.flyway_schema_history
    ADD CONSTRAINT flyway_schema_history_pk PRIMARY KEY (installed_rank);


--
-- Name: products products_pkey; Type: CONSTRAINT; Schema: public; Owner: ecommerce
--

ALTER TABLE ONLY public.products
    ADD CONSTRAINT products_pkey PRIMARY KEY (id);


--
-- Name: flyway_schema_history_s_idx; Type: INDEX; Schema: public; Owner: ecommerce
--

CREATE INDEX flyway_schema_history_s_idx ON public.flyway_schema_history USING btree (success);


--
-- Name: idx_category_name; Type: INDEX; Schema: public; Owner: ecommerce
--

CREATE INDEX idx_category_name ON public.categories USING btree (name);


--
-- Name: idx_product_category_id; Type: INDEX; Schema: public; Owner: ecommerce
--

CREATE INDEX idx_product_category_id ON public.products USING btree (category_id);


--
-- Name: idx_product_created_at; Type: INDEX; Schema: public; Owner: ecommerce
--

CREATE INDEX idx_product_created_at ON public.products USING btree (created_at DESC);


--
-- Name: idx_product_name_lower; Type: INDEX; Schema: public; Owner: ecommerce
--

CREATE INDEX idx_product_name_lower ON public.products USING btree (lower((name)::text));


--
-- Name: idx_product_name_price; Type: INDEX; Schema: public; Owner: ecommerce
--

CREATE INDEX idx_product_name_price ON public.products USING btree (lower((name)::text), price);


--
-- Name: idx_product_price; Type: INDEX; Schema: public; Owner: ecommerce
--

CREATE INDEX idx_product_price ON public.products USING btree (price);


--
-- Name: idx_product_stock; Type: INDEX; Schema: public; Owner: ecommerce
--

CREATE INDEX idx_product_stock ON public.products USING btree (stock_quantity) WHERE (stock_quantity > 0);


--
-- Name: products fkog2rp4qthbtt2lfyhfo32lsw9; Type: FK CONSTRAINT; Schema: public; Owner: ecommerce
--

ALTER TABLE ONLY public.products
    ADD CONSTRAINT fkog2rp4qthbtt2lfyhfo32lsw9 FOREIGN KEY (category_id) REFERENCES public.categories(id);


--
-- Name: product_images fkqnq71xsohugpqwf3c9gxmsuy; Type: FK CONSTRAINT; Schema: public; Owner: ecommerce
--

ALTER TABLE ONLY public.product_images
    ADD CONSTRAINT fkqnq71xsohugpqwf3c9gxmsuy FOREIGN KEY (product_id) REFERENCES public.products(id);


--
-- Name: categories fksaok720gsu4u2wrgbk10b5n8d; Type: FK CONSTRAINT; Schema: public; Owner: ecommerce
--

ALTER TABLE ONLY public.categories
    ADD CONSTRAINT fksaok720gsu4u2wrgbk10b5n8d FOREIGN KEY (parent_id) REFERENCES public.categories(id);


--
-- PostgreSQL database dump complete
--

\unrestrict v0OP3YbUi7ceByUeYjCSx0Fe25BGXfQHSn9ShEYXSLrf2oMDChKQ5liq6CqjdgF

